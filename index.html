<!DOCTYPE html>
<html lang="en">
   <head>
      <script src="/head.js"></script>
      <meta charset="utf-8"/>
      <meta name="viewport" content="width=device-width, initial-scale=1"/>
      <link rel="stylesheet" type="text/css" href="style.css" />
      <title>bee</title>
   </head>
   <body>
      <script src="/body.js"></script>
      <h1 id="h1">bee.fish</h1>
      <a href="notes.txt">Notes</a>
      <ul>
         <li>
            <a href="archive/">Archive</a>
         </li>
         <li>
            <a href="power-encoding/number/index.html">Number (power encoding)</a>
         </li>
         <li>
            <a href="id/index.html">Id timestamped identifier</a>
         </li>
         <li>
            <a href="pointer/index.html">Pointer</a>
         </li>
         <li>
            <a href="object/index.html">Object</a>
         </li>
         <li>
            <a href="memory/index.html">Memory</a>
         </li>
         <li>
            <a href="function/index.html">Functions</a>
         </li>
         <li>
            <a href="array/index.html">Arrays</a>
         </li>
         <li>
            <a href="typed-array/index.html">Typed Arrays (encoding)</a>
         </li>
         <li>
            <a href="image/index.html">Images</a>
         </li>
         <li>
            <a href="draw/index.html">Draw</a>
         </li>
         <li>
            <a href="server/database">Simple database in c++</a>
         </li>
         <li>
            <a href="server/https">Simple HTTPS server in c++</a>
         </li>
         <li>
            <a href="parser/index.html">Javascript Parser</a>
         </li>
         <li>
            <a href="server/parser">C++ Parser</a>
         </li>
         <li>
            <a href="map">Database Storage Map</a>
         </li>
      </ul>
      <h2>Register with bee.fish</h2>
      
      <a id="response" href="javascript:register()">Register</a>
      
      <script>
var url = "https://bee.fish/index.html";
var token = null;

async function register()
{
   
   var params = {}
   var authenticated =
      token && token.authenticated;
   if (authenticated)
   {
      params.method = "POST";
      params.body =
         JSON.stringify(
            {
               "token": token,
               "name": "draw",
               "method": "setItem",
               "key": "brett",
               "value": "silverman"
            }
         );
   }
   else 
   {
      params.method = "GET";
      params.credentials = "include";
   }
   params.headers = [];
   
   postMessage("Logging in...");
   
   fetch(url, params)
   .then(function(response) {
      return response.text();
   })
   .then(function(text) {
       var response = JSON.parse(text);
       token = response.token;
       if (token && token.authenticated)
          postMessage(text);
       else
          postMessage(text);
   })
   .catch(function(error) {
      postMessage("Request failed " + error)
   });
}

var response =
   document.getElementById("response");

window.onmessage = function(event) {

   response.innerHTML = event.data;
 
}
      </script>
      <script>
var h1 = document.getElementById("h1");
var hostname =
   window.location.hostname;
var port =
   window.location.port;
   
if (hostname)
   h1.innerHTML = hostname;
   
if (port)
   h1.innerHTML += ":" + port;


      </script>
   </body>
</html>
