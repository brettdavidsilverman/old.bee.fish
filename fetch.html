<!DOCTYPE html>
<html lang="en">
   <head>
      <script src="head.js"></script>
      <meta charset="utf-8"/>
      <meta name="viewport" content="width=device-width, initial-scale=1"/>
      <script src="console/console.js"></script>
      <script src="id/id.js"></script>
      <script src="short-hand/short-hand.js"></script>
      <script src="pointer/pointer.js"></script>
      <script src="object/object.js"></script>
     
      <link rel="stylesheet" type="text/css" href="../../style.css" />
      <title>Fetch</title>
   </head>
   <body>
      <script src="body.js"></script>
      <h1>Fetch</h1>
      <button onclick="go()">Go</button>
      <pre id="response"></pre>
      <pre>
         <script>
var url = "https://bee.fish/index.html";

async function fetchText() {
   
   fetch(
      url,
      {
         method: "GET",
         credentials: "include",
         headers: []
      }
   )
   .then(function(response) {
      return response.text();
   })
   .then(function(text) {
       alert("ok");
       postMessage(text.trim());
   })
   .catch(function(error) {
      alert("Request failed " + error)
   });
}

function go() {
   var xhr = new XMLHttpRequest();
   const url = 'https://bee.fish/credentials';
   xhr.open('GET', url, false);
   xhr.withCredentials = true;
   xhr.onreadystatechange = handler;
   xhr.send();
       
   function handler(event) {
      alert(this.status);
      postMessage(this.responseText.trim());
   }
}



var response =
   document.getElementById("response");

window.onmessage = function(event) {

   response.innerHTML = event.data;
 
}


fetchText();

         </script>
      </pre>
   </body>
</html>
