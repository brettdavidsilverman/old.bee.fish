<!DOCTYPE html>
<html lang="en">
   <head>
      <script src="/head.js"></script>
      <meta charset="utf-8"/>
      <meta name="viewport" content="width=device-width, initial-scale=1"/>
      <script src="../stream/stream.js"></script>
      <script src="../power-encoding/power-encoding.js"></script>
      <script src="../shorthand/shorthand.js"></script>
      <script src="id.js"></script>
      <link rel="stylesheet" type="text/css" href="/style.css" />
      <link rel="stylesheet" type="text/css" href="../style.css" />

      <title>Id</title>
   </head>
   <body>
      <script src="/body.js"></script>
      <h1>Id</h1>
      <a href="id.js">id.js</a>
      
      <h2>Usage</h2>
      <p>Create a new Id and write out its time
      in milliseconds and increment, and its key.</p>
      <pre>
         <script>
// Create the Id
var name = "test";
var id = new Id({name});

// Write out its default string
document.writeln(id);

// Write out its string encoded key
document.writeln(id.key);

// Create a new id from old key
var id2 = new Id({key:id.key});

         </script>
      </pre>

      <h2>Id Form</h2>
      <form>
         <button onclick="createId()" type="button">New</button>
         <br />
         Key
         <br />
         <textarea id="key" rows="3" cols="40"></textarea>
         <br />
         <button onclick="loadTime()" type="button">Ok</button>
         <br />
         Time
         <br />
         <input type="text" id="time"></input>
         <br />
         Increment
         <br />
         <input type="text" id="increment"></input>
         <br />
         <button onclick="loadKey()" type="button">Ok</button>
         <script style="display:none;">
function loadKey()
{
   var time =
      document.getElementById("time").value;
   var increment =
      document.getElementById("increment").value;

   var timestamp =
   {
      name,
      time: Number(time),
      increment: Number(increment)
   }
   
   id = new Id(timestamp);
      
   document.getElementById("key").value =
      id.key;
}

function loadTime()
{
   var key =
      document.getElementById("key").value;
   
   id = new Id({key});
   
   document.getElementById("time").value =
      id.time;
      
   document.getElementById("increment").value =
      id.increment;
      
   
}

function createId()
{
   id = new Id({name});

   document.getElementById("key").value =
      id.key;
   
   loadTime();
}

createId();
         </script>
      </form>

      <h2>Key sort order</h2>
      <p>This shows that earlier created Ids
      have a smaller key. This means they can
      be sorted earliest to latest.</p>
      <pre>
         <script>
var id1 = new Id({name});
var id2 = new Id({name});

document.writeln(id1.key < id2.key);
         </script>
      </pre>
    
      <h2>Copying</h2>
      <p>Ids can be copied by passing in
      the source id as the first parameter,
      a key or a timestamp</p>
      <pre>
         <script>

function compareEqual(label, id1, id2)
{
   document.writeln(
      label + ":\t" + (id1.equals(id2))
   );
}

var id3 = new Id(id);

compareEqual("id3", id, id3);

var id4 =
   new Id(
      {
         name: id.name,
         time: id.time,
         increment:  id.increment
      }
   );
   
compareEqual("id4", id,  id4);

var id5 = new Id({key: id.key});

compareEqual("id5", id, id5);


         </script>
      </pre>
      
      <h2>Example</h2>
      <p>Here we show how it creates an id
      for any custom class.</p>
      <pre id="example">
         <script>
class A
{
   id;
   
   constructor(input)
   {
      this.id = new Id(input);
   }
}

var a = new A();

var id = a.id;

document.writeln(
   a.id.toString()
);


a = new A(id);

document.writeln(
   a.id.toString()
);

         </script>
      </pre>
      
   </body>
</html>
