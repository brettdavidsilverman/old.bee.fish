<!DOCTYPE html>
<html lang="en">
   <head>
      <script src="/head.js"></script>
      <script src="../logon/authentication.js"></script>
      <script src="../logon/redirect.js"></script>
      <script src="../console/console.js"></script>
      <script src="../stream/stream.js"></script>
      <script src="../power-encoding/power-encoding.js"></script>
      <script src="../shorthand/shorthand.js"></script>
      <script src="../id/id.js"></script>
      <script src="../pointer/pointer.js"></script>
      <script src="../object/object.js"></script>
      <script src="storage.js"></script>
      <meta charset="utf-8"/>
      <meta name="viewport" content="width=device-width, initial-scale=1"/>
      <link rel="stylesheet" type="text/css" href="/style.css" />
      <link rel="stylesheet" type="text/css" href="../style.css" />

      <title>Remote Storage</title>
      <style>
script {
   display: none;
}
      </style>
   </head>
   <body>
      <script src="/body.js"></script>
      <script>
var console = new Console();
      </script>
      
      <h1 id="h1">Remote Storage</h1>
      <a href="storage.js">storage.js</a>
      
      <script style="display:block">
storage = new Storage(remoteStorage);
// storage = new Storage(localStorage);
// storage = new Storage(sessionStorage);
      </script>
      
      <h2>Set storage value</h2>
      <form>
         Key:
         <br />
         <input type="text" id="setKey" value="Name"></input>
         <br />
         Value:
         <br />
         <label for="setIsNull">Is Null</label>
         <input type="checkbox" id="setIsNull"></input>
         <br />
         <input type="text" id="setValue"></input>
         <br />
         <button onclick="setItem()" type="button">Ok</button>
         <br />
         <div id="setResponse"></div>
         <script>
async function setItem()
{
   var setKey = document.getElementById("setKey");
   var setValue = document.getElementById("setValue");
   var setIsNull = document.getElementById("setIsNull");
   
   var key = setKey.value;
   var value = setValue.value;
   var isNull = setIsNull.checked;
   if (isNull)
      value = null;

   storage.setItem(key, value).then(
      (json) =>
         alert(json.response)
   ).catch(
      (error) =>
         alert(error)
   );
   
   
}

var id = new Id({name: "storage"});
var key = id.key;

document.getElementById("setKey").value =
   key;

         </script>
      </form>
     
      <h2>Get storage value</h2>
      <form>
         Key:
         <br />
         <input type="text" id="getKey" value="Name"></input>
         <br />
         <button onclick="getItem()" type="button">Ok</button>
         <br />
         Value:
         <br />
         <label for="getIsNull">Is Null</label>
         <input type="checkbox" id="getIsNull"></input>
         <br />
         <div id="getValue"></div>
         
         <script>
function getItem()
{
   var getKey = document.getElementById("getKey");
   var getValue = document.getElementById("getValue");
   var getIsNull = document.getElementById("getIsNull");
   
   var key = getKey.value;
   
   getValue.innerHTML = "Getting...";
 
   storage.getItem(key).then(
      function(value) {
         getIsNull.checked = (value == null);
         getValue.innerHTML = "";
         if (value != null)
         {
            var textNode =
               document.createTextNode(value);
            getValue.appendChild(textNode);
         }
   
         alert("ok");
      }
   ).catch(
      function(error)
      {
         alert(error);
      }
   );
   
}
document.getElementById("getKey").value =
   key;
         </script>
      </form>
      
      <h2>Remove storage value</h2>
      <form>
         Key:
         <br />
         <input type="text" id="removeKey" value="Name"></input>
         <br />
         <button onclick="removeItem()" type="button">Ok</button>
         <script>
function removeItem()
{
   var removeKey = document.getElementById("removeKey");
   var key = getKey.value;
   
   storage.removeItem(key).then(
      (json) =>
         alert(json.response)
   ).catch(
      (error) =>
         alert(error)
   );
}

document.getElementById("removeKey").value =
   key;

         </script>
      </form>
      
      <h2>Clear storage</h2>
      <form>
         Clear:
         <br />
         <button onclick="clearData()" type="button">Ok</button>
         <script>
function clearData()
{
   storage.clear().then(
      (json) =>
         alert(json.response)
   ).catch(
      (error) =>
         alert(error)
   );
   
}


         </script>
      </form>
   </body>
</html>
